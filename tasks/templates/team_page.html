{% extends 'base_content.html' %}
{% block content %}
<div class="container">
  <div class="title-bar" style="background-color: antiquewhite; color: black;">
    <h1 class="section-title">{{teams.team_name}}</h1>
  </div>
  <div class="team-details-dropdown">
    <button class="btn btn-secondary dropdown-toggle custom-button" type="button" id="teamDetailsDropdown"
      data-toggle="collapse" data-target="#teamDetailsCollapse" aria-expanded="false"
      aria-controls="teamDetailsCollapse">
      View Team Details
    </button>
    <div class="collapse" id="teamDetailsCollapse">
      <div class="card card-body">
        <h2>Team Leader: {{ teams.team_leader }}</h2>
        <p>Description: {{ teams.team_description }}</p>
      </div>
    </div>
  </div>
  <div class="view-tasks-dropdown">
    <button class="btn btn-secondary dropdown-toggle custom-button" type="button" id="teamDetailsDropdown"
      data-toggle="collapse" data-target="#teamDetailsCollapse" aria-expanded="false"
      aria-controls="teamDetailsCollapse">
      View Tasks
    </button>
    <div class="card card-body">
    </div>
  </div>
  <div class="view-members-dropdown">
    <button class="btn btn-secondary dropdown-toggle custom-button" type="button" id="teamDetailsDropdown"
      data-toggle="collapse" data-target="#teamDetailsCollapse" aria-expanded="false"
      aria-controls="teamDetailsCollapse">
      View Members
    </button>
    <div class="card card-body">
    </div>
  </div>
</div>
<div class="encapsulate-box">
  <div class="row">
    <div class="col-9">
      <!-- <h2>Team Leader: {{teams.team_leader}}</h2>
      <h2>Description: {{teams.team_description}}</h2> -->
      <a href="{% url 'create_task' %}" class="btn btn-primary">Create task</a>
      {% if tasks %}
      {% for task in tasks %}
      <p>{{ task.title }}</p>
      {% if task.created_by == request.user or request.user in task.assigned_to.all %}
      <a href="{% url 'edit_task' task.id %}" class="btn btn-secondary">Edit task</a>
      {% endif %}
      <a href="{% url 'view_task' task.id %}" class="btn btn-secondary"> View task</a>
      {% endfor %}
      {% endif %}
      </form>
    </div>
    <div class="members-container col-3">
      <h4 class="members-title">Members</h4>
      <ul class="members-list">
        <a href="{% url 'add_members' %}" class="btn btn-primary"> Add Members</a>
        {% for member in teams_members %}
        <li class="members">{{member.username}} </li>
        {% if user == teams.team_leader and member.username != teams.team_leader %}
        <form method="post" action="{% url 'remove_member' team_id=teams.team_id username=member.username %}">
          {%csrf_token%}
          <input type="submit" value="Remove" class="btn btn-primary">
        </form>

        {% endif %}
        {%endfor%}
        <ul>
    </div>
  </div>
</div>
<div>
  {%if user == teams.team_leader %}
  <form method="post" action="{% url 'delete_team' team_id=teams.team_id %}">
    {%csrf_token%}
    <input type="submit" value="Delete Team" class="btn btn-primary">
  </form>
  {% else %}
  <form method="post" action="{% url 'leave_team' team_id=teams.team_id %}">
    {%csrf_token%}
    <input type="submit" value="Leave Team" class="btn btn-primary">
  </form>
  {% endif %}
</div>


{% endblock %}